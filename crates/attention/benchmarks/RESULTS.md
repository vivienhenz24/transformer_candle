# Attention Benchmarks

<!-- CORRECTNESS_START -->
| shape | dtype | max abs | max rel | max |Î”log| |
| --- | --- | --- | --- | --- |
| (1,4,32,64) | F32 | 2.98e-7 | 5.76e-7 | 2.98e-7 |
| (1,4,32,64) | BF16 | 0.00e0 | 0.00e0 | 0.00e0 |
| (1,4,32,64) | F16 | 2.44e-4 | 5.57e-4 | 2.44e-4 |
| (1,4,32,80) | F32 | 2.38e-7 | 4.27e-7 | 2.38e-7 |
| (1,4,32,80) | BF16 | 0.00e0 | 0.00e0 | 0.00e0 |
| (1,4,32,80) | F16 | 2.44e-4 | 6.49e-4 | 2.44e-4 |
| (1,4,32,128) | F32 | 2.38e-7 | 4.47e-7 | 2.38e-7 |
| (1,4,32,128) | BF16 | 1.95e-3 | 3.91e-3 | 1.95e-3 |
| (1,4,32,128) | F16 | 2.44e-4 | 5.32e-4 | 2.44e-4 |
| (1,4,128,64) | F32 | 4.17e-7 | 8.61e-7 | 4.17e-7 |
| (1,4,128,64) | BF16 | 1.95e-3 | 3.92e-3 | 1.95e-3 |
| (1,4,128,64) | F16 | 4.88e-4 | 9.35e-4 | 4.88e-4 |
| (1,4,128,80) | F32 | 4.17e-7 | 7.85e-7 | 4.17e-7 |
| (1,4,128,80) | BF16 | 3.91e-3 | 6.90e-3 | 3.91e-3 |
| (1,4,128,80) | F16 | 4.88e-4 | 8.83e-4 | 4.88e-4 |
| (1,4,128,128) | F32 | 4.77e-7 | 9.23e-7 | 4.77e-7 |
| (1,4,128,128) | BF16 | 1.95e-3 | 4.05e-3 | 1.95e-3 |
| (1,4,128,128) | F16 | 4.88e-4 | 9.45e-4 | 4.88e-4 |
| (1,4,512,64) | F32 | 7.15e-7 | 1.40e-6 | 7.15e-7 |
| (1,4,512,64) | BF16 | 3.91e-3 | 7.75e-3 | 3.91e-3 |
| (1,4,512,64) | F16 | 4.88e-4 | 9.73e-4 | 4.88e-4 |
| (1,4,512,80) | F32 | 6.56e-7 | 1.35e-6 | 6.56e-7 |
| (1,4,512,80) | BF16 | 3.91e-3 | 7.69e-3 | 3.91e-3 |
| (1,4,512,80) | F16 | 4.88e-4 | 9.74e-4 | 4.88e-4 |
| (1,4,512,128) | F32 | 7.15e-7 | 1.36e-6 | 7.15e-7 |
| (1,4,512,128) | BF16 | 3.91e-3 | 7.75e-3 | 3.91e-3 |
| (1,4,512,128) | F16 | 4.88e-4 | 9.73e-4 | 4.88e-4 |
| (1,4,2048,64) | F32 | 6.56e-7 | 1.34e-6 | 6.56e-7 |
| (1,4,2048,64) | BF16 | 3.91e-3 | 7.75e-3 | 3.91e-3 |
| (1,4,2048,64) | F16 | 4.88e-4 | 9.76e-4 | 4.88e-4 |
| (1,4,2048,80) | F32 | 7.15e-7 | 1.39e-6 | 7.15e-7 |
| (1,4,2048,80) | BF16 | 3.91e-3 | 7.75e-3 | 3.91e-3 |
| (1,4,2048,80) | F16 | 4.88e-4 | 9.77e-4 | 4.88e-4 |
| (1,4,2048,128) | F32 | 7.15e-7 | 1.38e-6 | 7.15e-7 |
| (1,4,2048,128) | BF16 | 3.91e-3 | 7.81e-3 | 3.91e-3 |
| (1,4,2048,128) | F16 | 4.88e-4 | 9.77e-4 | 4.88e-4 |
| (1,4,8192,64) | F32 | 6.56e-7 | 1.33e-6 | 6.56e-7 |
| (1,4,8192,64) | BF16 | 3.91e-3 | 7.81e-3 | 3.91e-3 |
| (1,4,8192,64) | F16 | 4.88e-4 | 9.77e-4 | 4.88e-4 |
| (1,4,8192,80) | F32 | 6.26e-7 | 1.27e-6 | 6.26e-7 |
| (1,4,8192,80) | BF16 | 3.91e-3 | 7.81e-3 | 3.91e-3 |
| (1,4,8192,80) | F16 | 4.88e-4 | 9.77e-4 | 4.88e-4 |
| (1,4,8192,128) | F32 | 7.45e-7 | 1.52e-6 | 7.45e-7 |
| (1,4,8192,128) | BF16 | 3.91e-3 | 7.81e-3 | 3.91e-3 |
| (1,4,8192,128) | F16 | 4.88e-4 | 9.77e-4 | 4.88e-4 |

<!-- CORRECTNESS_END -->

<!-- MEMORY_START -->
| backend | shape | dtype | tokens/sec | peak MB | steady MB |
| --- | --- | --- | --- | --- | --- |
| reference | (1,4,2048,64) | F32 | 158.97 K | 0.00 | 0.00 |
| fused | (1,4,2048,64) | F32 | 49.08 K | 0.00 | 0.00 |
| reference | (2,4,4096,128) | BF16 | 72.28 K | 0.00 | 0.00 |
| fused | (2,4,4096,128) | BF16 | 19.84 K | 0.00 | 0.00 |

<!-- MEMORY_END -->

<!-- THROUGHPUT_START -->
| backend | shape (b,h,s,d) | dtype | tokens/sec |
| --- | --- | --- | --- |
| reference | (1,4,128,64) | F32 | 876.44 K |
| fused | (1,4,128,64) | F32 | 533.77 K |
| reference | (1,4,128,64) | BF16 | 876.38 K |
| fused | (1,4,128,64) | BF16 | 549.86 K |
| reference | (1,4,128,128) | F32 | 862.43 K |
| fused | (1,4,128,128) | F32 | 328.56 K |
| reference | (1,4,128,128) | BF16 | 799.89 K |
| fused | (1,4,128,128) | BF16 | 353.58 K |
| reference | (1,4,512,64) | F32 | 616.19 K |
| fused | (1,4,512,64) | F32 | 167.77 K |
| reference | (1,4,512,64) | BF16 | 597.26 K |
| fused | (1,4,512,64) | BF16 | 172.06 K |
| reference | (1,4,512,128) | F32 | 444.76 K |
| fused | (1,4,512,128) | F32 | 129.45 K |
| reference | (1,4,512,128) | BF16 | 470.85 K |
| fused | (1,4,512,128) | BF16 | 131.23 K |
| reference | (1,4,2048,64) | F32 | 175.16 K |
| fused | (1,4,2048,64) | F32 | 47.32 K |
| reference | (1,4,2048,64) | BF16 | 174.71 K |
| fused | (1,4,2048,64) | BF16 | 47.46 K |
| reference | (1,4,2048,128) | F32 | 144.90 K |
| fused | (1,4,2048,128) | F32 | 39.89 K |
| reference | (1,4,2048,128) | BF16 | 144.08 K |
| fused | (1,4,2048,128) | BF16 | 40.00 K |
| reference | (2,4,128,64) | F32 | 839.40 K |
| fused | (2,4,128,64) | F32 | 585.89 K |
| reference | (2,4,128,64) | BF16 | 932.49 K |
| fused | (2,4,128,64) | BF16 | 574.04 K |
| reference | (2,4,128,128) | F32 | 741.09 K |
| fused | (2,4,128,128) | F32 | 359.23 K |
| reference | (2,4,128,128) | BF16 | 776.21 K |
| fused | (2,4,128,128) | BF16 | 333.91 K |
| reference | (2,4,512,64) | F32 | 606.64 K |
| fused | (2,4,512,64) | F32 | 173.99 K |
| reference | (2,4,512,64) | BF16 | 561.23 K |
| fused | (2,4,512,64) | BF16 | 172.02 K |
| reference | (2,4,512,128) | F32 | 465.56 K |
| fused | (2,4,512,128) | F32 | 130.91 K |
| reference | (2,4,512,128) | BF16 | 471.08 K |
| fused | (2,4,512,128) | BF16 | 133.29 K |
| reference | (2,4,2048,64) | F32 | 174.07 K |
| fused | (2,4,2048,64) | F32 | 44.98 K |
| reference | (2,4,2048,64) | BF16 | 176.84 K |
| fused | (2,4,2048,64) | BF16 | 45.16 K |
| reference | (2,4,2048,128) | F32 | 145.59 K |
| fused | (2,4,2048,128) | F32 | 37.40 K |
| reference | (2,4,2048,128) | BF16 | 142.58 K |
| fused | (2,4,2048,128) | BF16 | 38.24 K |

<!-- THROUGHPUT_END -->

